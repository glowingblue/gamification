{"version":3,"sources":["webpack://@fof/gamification/webpack/bootstrap","webpack://@fof/gamification/./forum.js","webpack://@fof/gamification/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@fof/gamification/./src/common/helpers/rankLabel.js","webpack://@fof/gamification/./src/common/models/Rank.js","webpack://@fof/gamification/./src/forum/components/AddAttributes.js","webpack://@fof/gamification/./src/forum/components/AddHotnessSort.js","webpack://@fof/gamification/./src/forum/components/AddVoteButtons.js","webpack://@fof/gamification/./src/forum/components/LevelBar.js","webpack://@fof/gamification/./src/forum/components/RankingsPage.js","webpack://@fof/gamification/./src/forum/components/VoteNotification.js","webpack://@fof/gamification/./src/forum/components/VotesModal.js","webpack://@fof/gamification/./src/forum/components/addUpvotesToDiscussion.js","webpack://@fof/gamification/./src/forum/index.js","webpack://@fof/gamification/external \"flarum.core.compat['Component']\"","webpack://@fof/gamification/external \"flarum.core.compat['Model']\"","webpack://@fof/gamification/external \"flarum.core.compat['app']\"","webpack://@fof/gamification/external \"flarum.core.compat['components/Button']\"","webpack://@fof/gamification/external \"flarum.core.compat['components/CommentPost']\"","webpack://@fof/gamification/external \"flarum.core.compat['components/DiscussionList']\"","webpack://@fof/gamification/external \"flarum.core.compat['components/DiscussionListItem']\"","webpack://@fof/gamification/external \"flarum.core.compat['components/Dropdown']\"","webpack://@fof/gamification/external \"flarum.core.compat['components/IndexPage']\"","webpack://@fof/gamification/external \"flarum.core.compat['components/LinkButton']\"","webpack://@fof/gamification/external \"flarum.core.compat['components/LoadingIndicator']\"","webpack://@fof/gamification/external \"flarum.core.compat['components/LogInModal']\"","webpack://@fof/gamification/external \"flarum.core.compat['components/Modal']\"","webpack://@fof/gamification/external \"flarum.core.compat['components/Notification']\"","webpack://@fof/gamification/external \"flarum.core.compat['components/Page']\"","webpack://@fof/gamification/external \"flarum.core.compat['components/PostUser']\"","webpack://@fof/gamification/external \"flarum.core.compat['components/UserCard']\"","webpack://@fof/gamification/external \"flarum.core.compat['extend']\"","webpack://@fof/gamification/external \"flarum.core.compat['helpers/avatar']\"","webpack://@fof/gamification/external \"flarum.core.compat['helpers/icon']\"","webpack://@fof/gamification/external \"flarum.core.compat['helpers/listItems']\"","webpack://@fof/gamification/external \"flarum.core.compat['helpers/username']\"","webpack://@fof/gamification/external \"flarum.core.compat['models/Discussion']\"","webpack://@fof/gamification/external \"flarum.core.compat['models/Post']\"","webpack://@fof/gamification/external \"flarum.core.compat['models/User']\"","webpack://@fof/gamification/external \"flarum.core.compat['utils/ItemList']\"","webpack://@fof/gamification/external \"flarum.core.compat['utils/PostControls']\"","webpack://@fof/gamification/external \"flarum.core.compat['utils/abbreviateNumber']\"","webpack://@fof/gamification/external \"flarum.core.compat['utils/mixin']\""],"names":["rankLabel","rank","attrs","style","className","color","backgroundColor","m","name","Rank","mixin","Model","points","attribute","Discussion","prototype","canVote","canSeeVotes","votes","User","ranks","hasMany","Post","upvotes","downvotes","matchClass","node","matchTag","tagName","tag","findMatchClass","newArray","children","nodeInChildren","find","undefined","concat","forEach","currentValue","extend","UserCard","items","user","app","forum","replace","props","data","attributes","Points","translator","trans","vnode","profile_node","badges_node","splice","reverse","map","i","push","PostUser","post","header_node","IndexPage","viewItems","ItemList","sortMap","cache","discussionList","sortOptions","dropDownLabel","params","sort","Object","keys","key","test","route","add","Dropdown","component","buttonClassName","label","value","active","redraw","Button","icon","onclick","changeSort","bind","LinkButton","href","filter","DiscussionList","hot","q","CommentPost","x","isInitialized","context","pusher","then","channels","main","userId","parseInt","session","id","startComputation","postId","upData","upvotedata","downData","downvotedata","before","removeVote","after","unshift","type","strategy","endComputation","unbind","PostControls","discussion","modal","show","VotesModal","prop","relationships","isUpvoted","some","isDownvoted","vote","themePrimaryColor","disabled","LogInModal","save","upvote","downvote","length","LevelBar","config","$","tooltip","container","view","pointsText","expComments","commentCount","discussionCount","expDiscussions","expLikes","expTotal","expLevel","Math","floor","expPercent","Component","RankingsPage","init","canViewRankingPage","loading","users","refresh","LoadingIndicator","loadMore","hero","affixSidebar","listItems","sidebarItems","toArray","addOrdinalSuffix","avatar","username","clear","loadResults","results","parseResults","j","k","stickyParams","param","actionItems","title","store","newDiscussion","deferred","composeNewDiscussion","onlogin","promise","DiscussionComposer","composer","load","resolve","offset","page","limit","apply","lazyRedraw","Page","UpvotedNotification","notification","content","subject","fromUser","excerpt","contentPlain","Notification","Modal","DiscussionListItem","addClass","abbreviateNumber","initializers","models","notificationComponents","VoteNotification","routes","rankings","path","AddVoteButtons","AddHotnessFilter","AddAttributes","addUpvotesToDiscussion"],"mappings":"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","file":"forum.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./forum.js\");\n","export * from './src/common';\nexport * from './src/forum';\n","export default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}","export default function rankLabel(rank, attrs = {}) {\n    attrs.style = attrs.style || {};\n    attrs.className = 'rankLabel ' + (attrs.className || '');\n\n    const color = rank.color();\n    attrs.style.backgroundColor = attrs.style.color = color;\n    attrs.className += ' colored';\n\n    return m('span', attrs, <span className=\"rankLabel-text\">{rank.name()}</span>);\n}\n","import Model from 'flarum/Model';\nimport mixin from 'flarum/utils/mixin';\n\nexport default class Rank extends mixin(Model, {\n    points: Model.attribute('points'),\n    name: Model.attribute('name'),\n    color: Model.attribute('color'),\n}) {}\n","import Discussion from 'flarum/models/Discussion';\nimport { extend } from 'flarum/extend';\nimport Model from 'flarum/Model';\nimport Post from 'flarum/models/Post';\nimport PostUser from 'flarum/components/PostUser';\nimport User from 'flarum/models/User';\nimport UserCard from 'flarum/components/UserCard';\nimport rankLabel from '../../common/helpers/rankLabel';\n\nexport default function() {\n    Discussion.prototype.canVote = Model.attribute('canVote');\n    Discussion.prototype.canSeeVotes = Model.attribute('canSeeVotes');\n    Discussion.prototype.votes = Model.attribute('votes');\n\n    User.prototype.points = Model.attribute('points');\n    User.prototype.ranks = Model.hasMany('ranks');\n\n    Post.prototype.upvotes = Model.hasMany('upvotes');\n    Post.prototype.downvotes = Model.hasMany('downvotes');\n\n    const matchClass = className => {\n        return node => node && node.attrs && node.attrs.className && node.attrs.className === className;\n    };\n\n    const matchTag = tagName => {\n        return node => node && node.tag && node.tag === tagName;\n    };\n\n    const findMatchClass = function(node, className) {\n        var newArray = [];\n        if (node && node.children) {\n            var nodeInChildren = node.children.find(matchClass(className));\n            if (nodeInChildren !== undefined) {\n                newArray = newArray.concat(nodeInChildren);\n            }\n            node.children.forEach(function(currentValue) {\n                newArray = newArray.concat(findMatchClass(currentValue, className));\n            });\n        }\n        return newArray;\n    };\n\n    extend(UserCard.prototype, 'infoItems', function(items, user) {\n        let points = '';\n\n        if (points == 0) {\n            points = '0';\n        }\n\n        if (app.forum.attribute('PointsPlaceholder')) {\n            points = app.forum.attribute('PointsPlaceholder').replace('{points}', this.props.user.data.attributes.Points);\n        } else {\n            points = app.translator.trans('fof-gamification.forum.user.points', { points: this.props.user.data.attributes.Points });\n        }\n\n        // items.add('points', points);\n    });\n\n    extend(UserCard.prototype, 'view', function(vnode) {\n        const user = this.props.user;\n        let profile_node = findMatchClass(vnode, 'UserCard-profile')[0];\n        let badges_node = profile_node.children.find(matchClass('UserCard-badges'));\n        if (user.ranks()) {\n            if (badges_node === undefined || badges_node === '') {\n                profile_node.children.splice(\n                    1,\n                    0,\n                    <ul className=\"UserCard-badges badges\">\n                        {user\n                            .ranks()\n                            .reverse()\n                            .map((rank, i) => {\n                                if (i >= app.forum.attribute('ranksAmt') && app.forum.attribute('ranksAmt') !== null) {\n                                } else {\n                                    return <li className=\"User-Rank\">{rankLabel(rank)}</li>;\n                                }\n                            })}\n                    </ul>\n                );\n            } else {\n                badges_node.children.push(\n                    user\n                        .ranks()\n                        .reverse()\n                        .map((rank, i) => {\n                            if (i >= app.forum.attribute('ranksAmt') && app.forum.attribute('ranksAmt') !== null) {\n                            } else {\n                                return <li className=\"User-Rank\">{rankLabel(rank)}</li>;\n                            }\n                        })\n                );\n            }\n        }\n\n        return vnode;\n    });\n\n    extend(PostUser.prototype, 'view', function(vnode) {\n        const post = this.props.post;\n        const user = post.user();\n\n        if (!user) {\n            return vnode;\n        }\n\n        const header_node = vnode.children.find(matchTag('h3'));\n        header_node.children.push(\n            user\n                .ranks()\n                .reverse()\n                .map((rank, i) => {\n                    if (i >= app.forum.attribute('ranksAmt') && app.forum.attribute('ranksAmt') !== null) {\n                    } else {\n                        return <span className=\"Post-Rank\">{rankLabel(rank)}</span>;\n                    }\n                })\n        );\n\n        return vnode;\n    });\n}\n","import { extend } from 'flarum/extend';\nimport IndexPage from 'flarum/components/IndexPage';\nimport ItemList from 'flarum/utils/ItemList';\nimport DiscussionList from 'flarum/components/DiscussionList';\nimport Dropdown from 'flarum/components/Dropdown';\nimport Button from 'flarum/components/Button';\nimport LinkButton from 'flarum/components/LinkButton';\n\nexport default function() {\n    IndexPage.prototype.viewItems = function() {\n        const items = new ItemList();\n        const sortMap = app.cache.discussionList.sortMap();\n\n        const sortOptions = {};\n        for (const i in sortMap) {\n            sortOptions[i] = app.translator.trans('core.forum.index_sort.' + i + '_button');\n        }\n\n        let dropDownLabel = sortOptions[this.params().sort] || Object.keys(sortMap).map(key => sortOptions[key])[0];\n\n        if (/^.*?\\/hot/.test(m.route())) {\n            dropDownLabel = app.translator.trans('core.forum.index_sort.hot_button');\n        }\n\n        items.add(\n            'sort',\n            Dropdown.component({\n                buttonClassName: 'Button',\n                label: dropDownLabel,\n                children: Object.keys(sortOptions).map(value => {\n                    const label = sortOptions[value];\n                    let active = (this.params().sort || Object.keys(sortMap)[0]) === value;\n\n                    if (/^.*?\\/hot/.test(m.route()) && value === 'hot') {\n                        active = true;\n                    }\n\n                    if (/^.*?\\/hot/.test(m.route()) && value === 'latest') {\n                        active = false;\n                        m.redraw();\n                    }\n\n                    return Button.component({\n                        children: label,\n                        icon: active ? 'fas fa-check' : true,\n                        onclick: this.changeSort.bind(this, value),\n                        active: active,\n                    });\n                }),\n            })\n        );\n\n        return items;\n    };\n\n    extend(IndexPage.prototype, 'navItems', function(items) {\n        items.add(\n            'rankings',\n            LinkButton.component({\n                href: app.route('rankings'),\n                children: app.translator.trans('fof-gamification.forum.nav.name'),\n                icon: 'fas fa-trophy',\n            }),\n            80\n        );\n    });\n\n    IndexPage.prototype.changeSort = function(sort) {\n        const params = this.params();\n\n        if (sort === 'hot') {\n            m.route('/');\n            m.route(m.route() + 'hot');\n        } else {\n            if (sort === Object.keys(app.cache.discussionList.sortMap())[0]) {\n                delete params.sort;\n            } else {\n                params.sort = sort;\n            }\n            if (params.filter === 'hot') {\n                delete params.filter;\n            }\n            m.route(app.route('index', params));\n        }\n    };\n\n    extend(DiscussionList.prototype, 'sortMap', function(map) {\n        map.hot = 'hot';\n    });\n\n    extend(DiscussionList.prototype, 'requestParams', function(params) {\n        if (this.props.params.filter === 'hot') {\n            params.filter.q = ' is:hot';\n        }\n    });\n}\n","import { extend } from 'flarum/extend';\nimport app from 'flarum/app';\nimport Button from 'flarum/components/Button';\nimport LogInModal from 'flarum/components/LogInModal';\nimport CommentPost from 'flarum/components/CommentPost';\nimport PostControls from 'flarum/utils/PostControls';\nimport VotesModal from './VotesModal';\n\nexport default function() {\n    extend(CommentPost.prototype, 'config', function(x, isInitialized, context) {\n        if (isInitialized) return;\n\n        if (app.pusher) {\n            app.pusher.then(channels => {\n                channels.main.bind('newVote', data => {\n                    var userId = parseInt(data.userId);\n\n                    if (userId == app.session.user.id()) return;\n\n                    m.startComputation();\n\n                    if (this.postId() == data.postId) {\n                        var upData = this.upvotedata();\n                        var downData = this.downvotedata();\n\n                        switch (data.before) {\n                            case 'up':\n                                upData = this.removeVote(upData, userId);\n                                break;\n                            case 'down':\n                                downData = this.removeVote(downData, userId);\n                                break;\n                        }\n\n                        switch (data.after) {\n                            case 'up':\n                                upData.unshift({ type: 'users', id: userId });\n                                break;\n                            case 'down':\n                                downData.unshift({ type: 'users', id: userId });\n                                break;\n                            case 'none':\n                                downData = this.removeVote(downData, userId);\n                                upData = this.removeVote(upData, userId);\n                                break;\n                        }\n\n                        this.downvotedata(downData);\n                        this.upvotedata(upData);\n\n                        m.redraw.strategy('all');\n                    }\n\n                    m.endComputation();\n                });\n\n                extend(context, 'onunload', () => channels.main.unbind('newVote'));\n            });\n        }\n    });\n\n    extend(PostControls, 'moderationControls', function(items, post) {\n        if (post.discussion().canSeeVotes()) {\n            items.add('viewVotes', [\n                m(\n                    Button,\n                    {\n                        icon: 'fas fa-thumbs-up',\n                        onclick: () => {\n                            app.modal.show(new VotesModal({ post }));\n                        },\n                    },\n                    app.translator.trans('fof-gamification.forum.mod_item')\n                ),\n            ]);\n        }\n    });\n\n    extend(CommentPost.prototype, 'actionItems', function(items) {\n        const post = this.props.post;\n\n        this.postId = m.prop(post.data.id);\n\n        this.downvotedata = m.prop(post.data.relationships.downvotes.data);\n        this.upvotedata = m.prop(post.data.relationships.upvotes.data);\n\n        let isUpvoted = app.session.user && post.upvotes().some(user => user === app.session.user);\n        let isDownvoted = app.session.user && post.downvotes().some(user => user === app.session.user);\n\n        if (!app.session.user) {\n            isDownvoted = false;\n            isUpvoted = false;\n        }\n\n        let icon = app.forum.attribute('IconName');\n\n        if (icon === null || icon === '') {\n            icon = 'thumbs';\n        }\n\n        this.removeVote = function(data, userId) {\n            data.some((vote, i) => {\n                if (vote.id == userId) {\n                    data.splice(i, 1);\n                }\n            });\n            return data;\n        };\n\n        items.add(\n            'upvote',\n            Button.component({\n                icon: 'fas fa-' + icon + '-up',\n                className: 'Post-vote Post-upvote',\n                style: isUpvoted !== false ? 'color:' + app.forum.data.attributes.themePrimaryColor : 'color:',\n                disabled: !post.discussion().canVote(),\n                onclick: () => {\n                    if (!app.session.user) {\n                        app.modal.show(new LogInModal());\n                        return;\n                    }\n                    if (!post.discussion().canVote()) return;\n\n                    var upData = post.data.relationships.upvotes.data;\n                    var downData = post.data.relationships.downvotes.data;\n\n                    isUpvoted = !isUpvoted;\n\n                    isDownvoted = false;\n\n                    post.save([isUpvoted, isDownvoted, 'vote']);\n\n                    upData.some((upvote, i) => {\n                        if (upvote.id === app.session.user.id()) {\n                            upData.splice(i, 1);\n                            return true;\n                        }\n                    });\n                    downData.some((downvote, i) => {\n                        if (downvote.id === app.session.user.id()) {\n                            downData.splice(i, 1);\n                            return true;\n                        }\n                    });\n                    if (isUpvoted) {\n                        upData.unshift({ type: 'users', id: app.session.user.id() });\n                    }\n                },\n            }),\n            3\n        );\n\n        items.add('points', <label className=\"Post-points\">{this.upvotedata().length - this.downvotedata().length}</label>, 2);\n\n        items.add(\n            'downvote',\n            Button.component({\n                icon: 'fas fa-' + icon + '-down',\n                className: 'Post-vote Post-downvote',\n                style: isDownvoted !== false ? 'color:' + app.forum.data.attributes.themePrimaryColor : '',\n                disabled: !post.discussion().canVote(),\n                onclick: () => {\n                    if (!app.session.user) {\n                        app.modal.show(new LogInModal());\n                        return;\n                    }\n                    if (!post.discussion().canVote()) return;\n\n                    var upData = post.data.relationships.upvotes.data;\n                    var downData = post.data.relationships.downvotes.data;\n\n                    isDownvoted = !isDownvoted;\n\n                    isUpvoted = false;\n\n                    post.save([isUpvoted, isDownvoted, 'vote']);\n\n                    upData.some((upvote, i) => {\n                        if (upvote.id === app.session.user.id()) {\n                            upData.splice(i, 1);\n                            return true;\n                        }\n                    });\n                    downData.some((downvote, i) => {\n                        if (downvote.id === app.session.user.id()) {\n                            downData.splice(i, 1);\n                            return true;\n                        }\n                    });\n\n                    if (isDownvoted) {\n                        downData.unshift({ type: 'users', id: app.session.user.id() });\n                    }\n                },\n            }),\n            1\n        );\n    });\n}\n","import Component from 'flarum/Component';\nimport app from 'flarum/app';\n\nexport default class LevelBar extends Component {\n    config() {\n        this.$().tooltip({ container: 'body' });\n    }\n\n    view() {\n        const user = this.props.post.user();\n        const pointsText = app.translator.trans(\n            'fof-gamification.forum.ranking.level'\n        );\n\n        let expComments = (user.commentCount() - user.discussionCount()) * 21,\n            expDiscussions = user.discussionCount() * 33,\n            expLikes = user.data.attributes.Points * 11;\n\n        let expTotal = expComments + expDiscussions + expLikes,\n            expLevel = Math.floor(expTotal / 135),\n            expPercent = (100 / 135) * (expTotal - expLevel * 135);\n\n        return (\n            <div\n                class='PostUser-level'\n                title={`${expTotal} ${app.translator.trans(\n                    'fof-gamification.forum.ranking.expText'\n                )}`}\n            >\n                <span class='PostUser-text'>\n                    <span class='PostUser-levelText'>{pointsText}</span>\n                    &nbsp;\n                    <span class='PostUser-levelPoints'>{expLevel}</span>\n                </span>\n                <div class='PostUser-bar PostUser-bar--empty'></div>\n                <div class='PostUser-bar' style={'width: ' + expPercent + '%;'}></div>\n            </div>\n        );\n    }\n}\n","import { extend } from 'flarum/extend';\nimport avatar from 'flarum/helpers/avatar';\nimport Page from 'flarum/components/Page';\nimport IndexPage from 'flarum/components/IndexPage';\nimport Button from 'flarum/components/Button';\nimport ItemList from 'flarum/utils/ItemList';\nimport LogInModal from 'flarum/components/LogInModal';\nimport LoadingIndicator from 'flarum/components/LoadingIndicator';\nimport listItems from 'flarum/helpers/listItems';\nimport username from 'flarum/helpers/username';\n\nexport default class RankingsPage extends Page {\n    init() {\n        super.init();\n\n        if (!app.session.user || app.session.user.data.attributes.canViewRankingPage !== true) {\n            m.route('/');\n        }\n\n        this.loading = true;\n        this.users = [];\n        this.refresh();\n    }\n\n    view() {\n        let loading;\n\n        if (this.loading) {\n            loading = LoadingIndicator.component();\n        } else if (this.users.length < 25 ) {\n            loading = Button.component({\n                children: app.translator.trans('core.forum.discussion_list.load_more_button'),\n                className: 'Button',\n                onclick: this.loadMore.bind(this),\n            });\n        }\n        return (\n            <div className=\"TagsPage\">\n                {IndexPage.prototype.hero()}\n                <div className=\"container\">\n                    <nav className=\"RankingPage-nav IndexPage-nav sideNav\" config={IndexPage.prototype.affixSidebar}>\n                        <ul>{listItems(IndexPage.prototype.sidebarItems().toArray())}</ul>\n                    </nav>\n                    <div className=\"RankingPage sideNavOffset\">\n                        <table class=\"rankings\">\n                            <tr>\n                                <th className=\"rankings-mobile\">{app.translator.trans('fof-gamification.forum.ranking.rank')}</th>\n                                <th>{app.translator.trans('fof-gamification.forum.ranking.name')}</th>\n                                <th>{app.translator.trans('fof-gamification.forum.ranking.level')}</th>\n                            </tr>\n                            {this.users.map((user, i) => {\n                                ++i;\n                                return [\n                                    <tr className={'ranking-' + i}>\n                                        {i < 4 ? (\n                                            app.forum.attribute('CustomRankingImages') == '1' ? (\n                                                <img\n                                                    className=\"rankings-mobile rankings-image\"\n                                                    src={app.forum.attribute('baseUrl') + app.forum.attribute('topimage' + i + 'Url')}\n                                                />\n                                            ) : (\n                                                <td className={'rankings-mobile rankings-' + i}>\n                                                    <i className=\"icon fas fa-trophy\"></i>\n                                                </td>\n                                            )\n                                        ) : (\n                                            <td className=\"rankings-4 rankings-mobile\">{this.addOrdinalSuffix(i)}</td>\n                                        )}\n                                        <td>\n                                            <div className=\"PostUser\">\n                                                <h3 className=\"rankings-info\">\n                                                    <a href={app.route.user(user)} config={m.route}>\n                                                        {i < 4 ? avatar(user, { className: 'info-avatar rankings-' + i + '-avatar' }) : ''}{' '}\n                                                        {username(user)}\n                                                    </a>\n                                                </h3>\n                                            </div>\n                                        </td>\n                                        {i < 4 ? (\n                                            <td className={'rankings-' + i}>{user.expLevel}</td>\n                                        ) : (\n                                            <td className=\"rankings-4\">{user.expLevel}</td>\n                                        )}\n                                    </tr>,\n                                ];\n                            })}\n                        </table>\n                        <div className=\"rankings-loadmore\"> {loading}</div>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n\n    refresh(clear = true) {\n        if (clear) {\n            this.loading = true;\n            this.users = [];\n        }\n\n        return this.loadResults().then(\n            results => {\n                this.users = [];\n                this.parseResults(results);\n            },\n            () => {\n                this.loading = false;\n                m.redraw();\n            }\n        );\n    }\n\n    addOrdinalSuffix(i) {\n        if (app.forum.attribute('DefaultLocale') == 'en') {\n            var j = i % 10,\n                k = i % 100;\n            if (j == 1 && k != 11) {\n                return i + 'st';\n            }\n            if (j == 2 && k != 12) {\n                return i + 'nd';\n            }\n            if (j == 3 && k != 13) {\n                return i + 'rd';\n            }\n            return i + 'th';\n        } else {\n            return i;\n        }\n    }\n\n    stickyParams() {\n        return {\n            sort: m.route.param('sort'),\n            q: m.route.param('q'),\n        };\n    }\n\n    actionItems() {\n        const items = new ItemList();\n\n        items.add(\n            'refresh',\n            Button.component({\n                title: app.translator.trans('core.forum.index.refresh_tooltip'),\n                icon: 'fas fa-refresh',\n                className: 'Button Button--icon',\n                onclick: () => {\n                    app.cache.discussionList.refresh();\n                    if (app.session.user) {\n                        app.store.find('users', app.session.user.id());\n                        m.redraw();\n                    }\n                },\n            })\n        );\n\n        return items;\n    }\n\n    newDiscussion() {\n        const deferred = m.deferred();\n\n        if (app.session.user) {\n            this.composeNewDiscussion(deferred);\n        } else {\n            app.modal.show(\n                new LogInModal({\n                    onlogin: this.composeNewDiscussion.bind(this, deferred),\n                })\n            );\n        }\n\n        return deferred.promise;\n    }\n\n    composeNewDiscussion(deferred) {\n        const component = new DiscussionComposer({ user: app.session.user });\n\n        app.composer.load(component);\n        app.composer.show();\n\n        deferred.resolve(component);\n\n        return deferred.promise;\n    }\n\n    loadResults(offset) {\n        const params = {};\n        params.page = {\n            offset: offset,\n            limit: '10',\n        };\n\n        return app.store.find('rankings', params);\n    }\n\n    loadMore() {\n        this.loading = true;\n\n        this.loadResults(this.users.length).then(this.parseResults.bind(this));\n    }\n\n    parseResults(results) {\n        [].push.apply(this.users, results);\n\n        this.loading = false;\n\n        this.users.forEach(user => {\n            let expComments = (user.commentCount() - user.discussionCount()) * 21,\n                expDiscussions = user.discussionCount() * 33,\n                expLikes = user.data.attributes.Points * 11;\n\n            let expTotal = expComments + expDiscussions + expLikes,\n                expLevel = Math.floor(expTotal / 135);\n            user.expLevel = expLevel;\n        });\n\n        m.lazyRedraw();\n\n        return results;\n    }\n}\n","import Notification from 'flarum/components/Notification';\n\nexport default class UpvotedNotification extends Notification {\n    icon() {\n        if (this.props.notification.content() === 'Up') {\n            return 'fas fa-thumbs-up';\n        } else {\n            return 'fas fa-thumbs-down';\n        }\n    }\n\n    href() {\n        return app.route.post(this.props.notification.subject());\n    }\n\n    content() {\n        let username = this.props.notification.fromUser().username();\n\n        if (this.props.notification.content() === 'Up') {\n            return app.translator.trans('fof-gamification.forum.notification.upvote', { username });\n        } else {\n            return app.translator.trans('fof-gamification.forum.notification.downvote', { username });\n        }\n    }\n\n    excerpt() {\n        return this.props.notification.subject().contentPlain();\n    }\n}\n","import Modal from 'flarum/components/Modal';\nimport avatar from 'flarum/helpers/avatar';\nimport username from 'flarum/helpers/username';\n\nexport default class VotesModal extends Modal {\n    className() {\n        return 'VotesModal Modal--small';\n    }\n\n    title() {\n        return app.translator.trans('fof-gamification.forum.modal.title');\n    }\n\n    content() {\n        return (\n            <div className=\"Modal-body\">\n                <ul className=\"VotesModal-list\">\n                    <legend>{app.translator.trans('fof-gamification.forum.modal.upvotes_label')}</legend>\n                    {this.props.post.upvotes().map(user => (\n                        <li>\n                            <a href={app.route.user(user)} config={m.route}>\n                                {avatar(user)} {username(user)}\n                            </a>\n                        </li>\n                    ))}\n                    <legend>{app.translator.trans('fof-gamification.forum.modal.downvotes_label')}</legend>\n                    {this.props.post.downvotes().map(user => (\n                        <li>\n                            <a href={app.route.user(user)} config={m.route}>\n                                {avatar(user)} {username(user)}\n                            </a>\n                        </li>\n                    ))}\n                </ul>\n            </div>\n        );\n    }\n}\n","import { extend } from 'flarum/extend';\nimport DiscussionListItem from 'flarum/components/DiscussionListItem';\nimport abbreviateNumber from 'flarum/utils/abbreviateNumber';\nimport icon from 'flarum/helpers/icon';\n\nexport default function () {\n    extend(DiscussionListItem.prototype, 'infoItems', function(items) {\n        if (app.forum.attribute('showVotesOnDiscussionPage')) {\n            $('.DiscussionListItem-info').find('.item-tags').addClass('gamification');\n            items.add('discussion-votes', (\n                <span className=\"DiscussionListItem-votes\" title={app.translator.trans('fof-gamification.forum.votes')}>\n                {icon('far fa-thumbs-up')}\n                    {abbreviateNumber(this.props.discussion.votes())}\n            </span>\n            ), 10);\n        }\n    });\n}","import { extend } from 'flarum/extend';\nimport app from 'flarum/app';\nimport AddAttributes from './components/AddAttributes';\nimport AddHotnessFilter from './components/AddHotnessSort';\nimport AddVoteButtons from './components/AddVoteButtons';\nimport Rank from '../common/models/Rank';\nimport RankingsPage from './components/RankingsPage';\nimport VoteNotification from './components/VoteNotification';\nimport addUpvotesToDiscussion from './components/addUpvotesToDiscussion';\nimport PostUser from 'flarum/components/PostUser';\nimport LevelBar from './components/LevelBar';\n\napp.initializers.add('fof-gamification', app => {\n    app.store.models.ranks = Rank;\n\n    app.notificationComponents.vote = VoteNotification;\n\n    app.routes.rankings = { path: '/rankings', component: RankingsPage.component() };\n\n    AddVoteButtons();\n    AddHotnessFilter();\n    AddAttributes();\n    addUpvotesToDiscussion();\n\n    extend(PostUser.prototype, 'view', function(view) {\n        view.children.push(LevelBar.component(this.props));\n    });\n});\n","module.exports = flarum.core.compat['Component'];","module.exports = flarum.core.compat['Model'];","module.exports = flarum.core.compat['app'];","module.exports = flarum.core.compat['components/Button'];","module.exports = flarum.core.compat['components/CommentPost'];","module.exports = flarum.core.compat['components/DiscussionList'];","module.exports = flarum.core.compat['components/DiscussionListItem'];","module.exports = flarum.core.compat['components/Dropdown'];","module.exports = flarum.core.compat['components/IndexPage'];","module.exports = flarum.core.compat['components/LinkButton'];","module.exports = flarum.core.compat['components/LoadingIndicator'];","module.exports = flarum.core.compat['components/LogInModal'];","module.exports = flarum.core.compat['components/Modal'];","module.exports = flarum.core.compat['components/Notification'];","module.exports = flarum.core.compat['components/Page'];","module.exports = flarum.core.compat['components/PostUser'];","module.exports = flarum.core.compat['components/UserCard'];","module.exports = flarum.core.compat['extend'];","module.exports = flarum.core.compat['helpers/avatar'];","module.exports = flarum.core.compat['helpers/icon'];","module.exports = flarum.core.compat['helpers/listItems'];","module.exports = flarum.core.compat['helpers/username'];","module.exports = flarum.core.compat['models/Discussion'];","module.exports = flarum.core.compat['models/Post'];","module.exports = flarum.core.compat['models/User'];","module.exports = flarum.core.compat['utils/ItemList'];","module.exports = flarum.core.compat['utils/PostControls'];","module.exports = flarum.core.compat['utils/abbreviateNumber'];","module.exports = flarum.core.compat['utils/mixin'];"],"sourceRoot":""}